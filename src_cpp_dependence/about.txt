This source contains the cpp part. 
